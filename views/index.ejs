<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>FeedForward</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <link href="/assets/img/favicon.png" rel="icon">
  <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="/assets/css/main.css" rel="stylesheet">
  <style>
    body {
      background-color: black;
    }

    #hero {
      width: 100%;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-size: cover;
      background-position: center;
      padding-top: 60px;
    }

    .hero .container {
      background-color: rgba(88, 86, 86, 0.6);
      padding: 20px;
      border-radius: 10px;
      color: #fff;
    }

    .hero h2,
    .hero p {
      color: #fff;
    }

    .modal-header {
      border-bottom: none;
    }

    .modal-body {
      padding-top: 0;
    }

    .modal-footer {
      border-top: none;
    }

    .modal-content {
      background-color: #2c2c2c;
      color: #fff;
    }

    .form-control {
      background-color: #3c3c3c;
      border: none;
      color: #fff;
    }

    .form-control:focus {
      background-color: #4a4a4a;
      color: #fff;
      box-shadow: none;
      border-color: #5c5c5c;
    }

    .btn-primary {
      background-color: #ff5e57;
      border-color: #ff5e57;
    }

    .btn-primary:hover {
      background-color: #ff3b30;
      border-color: #ff3b30;
    }

    .error-message {
      color: #ff5e57;
      font-size: 0.9em;
    }

    .success-message {
      color: #28a745;
      font-size: 0.9em;
    }
  </style>
</head>

<body class="index-page">

  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl position-relative d-flex align-items-center">

      <a href="/" class="logo d-flex align-items-center me-auto">
        <h1 class="sitename">FeedForward</h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <ul id="nav">
          <li><a href="/" class="active">Home<br></a></li>
          <li><a href="/consumer/dashboard" class="active">Search<br></a></li>
          <li><a href="/about" class="active">About<br></a></li>
          <li><a href="/services" class="active">Services<br></a></li>
          <li><a href="/contact" class="active">Contact<br></a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>

      <a href="#" class="btn-getstarted" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a>
      <a href="#" class="btn-getstarted ms-3" data-bs-toggle="modal" data-bs-target="#registerModal">Register</a>
    </div>
  </header>

  <main class="main">
    <section id="hero" class="hero section dark-background">
      <img src="/assets/img/world-dotted-map.png" alt="" class="hero-bg" data-aos="fade-in">
      <div class="container">
        <div class="row gy-4 d-flex justify-content-between">
          <div class="col-lg-6 order-2 order-lg-1 d-flex flex-column justify-content-center">
            <h2 data-aos="fade-up">Turn Leftovers into Lifesavers with FeedForward</h2>
            <p data-aos="fade-up" data-aos-delay="100">FeedForward is a revolutionary platform that bridges the gap between food waste and food insecurity. Using real-time, location-based technology, we connect restaurants, groceries, and food services with surplus food to individuals and charities in need, ensuring that excess food is redirected to serve communities rather than landfills. Join us in making a sustainable impact, one meal at a time.</p>
            <form  class="form-search d-flex align-items-stretch mb-3" data-aos="fade-up" data-aos-delay="200">
              <input type="text" class="form-control" placeholder="Your City. e.g. New York" style="color: black;" id="city">
              <button type="button" class="btn btn-primary" onclick="save()">Search</button>
            </form>
            <div class="row gy-4" data-aos="fade-up" data-aos-delay="300">
              <div class="col-lg-3 col-6">
                <div class="stats-item text-center w-100 h-100">
                  <span data-purecounter-start="0" data-purecounter-end="232" data-purecounter-duration="0" class="purecounter">232</span>
                  <p>Meals Distributed</p>
                </div>
              </div>
              <div class="col-lg-3 col-6">
                <div class="stats-item text-center w-100 h-100">
                  <span data-purecounter-start="0" data-purecounter-end="521" data-purecounter-duration="0" class="purecounter">521</span>
                  <p>Waste Reduced (Kg)</p>
                </div>
              </div>
              <div class="col-lg-3 col-6">
                <div class="stats-item text-center w-100 h-100">
                  <span data-purecounter-start="0" data-purecounter-end="1453" data-purecounter-duration="0" class="purecounter">1453</span>
                  <p>Active Participants</p>
                </div>
              </div>
              <div class="col-lg-3 col-6">
                <div class="stats-item text-center w-100 h-100">
                  <span data-purecounter-start="0" data-purecounter-end="32" data-purecounter-duration="0" class="purecounter">32</span>
                  <p>Communities Served</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-5 order-1 order-lg-2 hero-img" data-aos="zoom-out">
            <img src="/assets/downloaded/undraw_eating_together_re_ux62.svg" class="img-fluid mb-3 mb-lg-0" alt="">
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalLabel" style="color: white;">Login</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="loginForm">
            <div class="mb-3">
              <label for="loginEmail" class="form-label">Email address</label>
              <input type="email" class="form-control" id="loginEmail" required>
            </div>
            <div class="mb-3">
              <label for="loginPassword" class="form-label">Password</label>
              <input type="password" class="form-control" id="loginPassword" required>
            </div>
            <div id="loginError" class="error-message"></div>
            <div id="loginSuccess" class="success-message"></div>
            <button type="submit" class="btn btn-primary w-100">Login</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Register Modal -->
  <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="registerModalLabel" style="color: white;">Register</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="registerForm">
            <div class="mb-3">
              <label for="registerName" class="form-label">Name</label>
              <input type="text" class="form-control" id="registerName" required>
            </div>
            <div class="mb-3">
              <label for="registerEmail" class="form-label">Email address</label>
              <input type="email" class="form-control" id="registerEmail" required>
            </div>
            <div class="mb-3">
              <label for="registerPassword" class="form-label">Password</label>
              <input type="password" class="form-control" id="registerPassword" required>
            </div>
            <div class="mb-3">
              <label for="registerRole" class="form-label">Role</label>
              <select class="form-select" id="registerRole" required>
                <option value="donor">Donor</option>
                <!-- <option value="consumer">Consumer</option> -->
              </select>
            </div>
            <div id="registerError" class="error-message"></div>
            <div id="registerSuccess" class="success-message"></div>
            <button type="submit" class="btn btn-primary w-100">Register</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/assets/vendor/php-email-form/validate.js"></script>
  <script src="/assets/vendor/aos/aos.js"></script>
  <script src="/assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="/assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="/assets/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Main JS File -->
  <script src="/assets/js/main.js"></script>

  <!-- Custom JS for Modal Handling -->
  <script>
   document.getElementById('loginForm').addEventListener('submit', async function (e) {
  e.preventDefault();
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  try {
    const response = await fetch('/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email, password }),
    });

    const data = await response.json();
    if (response.ok) {
      // Save the token to localStorage
      localStorage.setItem('authToken', data.token);
      localStorage.setItem('role', 'donor')

      // Redirect based on role
      if (data.user.role === 'donor') {
        window.location.href = '/donor/dashboard';
       
      } else if (data.user.role === 'consumer') {
      
        window.location.href = '/consumer/dashboard';
      }
    } else {
      document.getElementById('loginError').textContent = data.error || 'Invalid credentials';
    }
  } catch (error) {
    document.getElementById('loginError').textContent = 'An error occurred. Please try again later.';
  }
});
document.getElementById('registerForm').addEventListener('submit', async function (e) {
  e.preventDefault();
  const name = document.getElementById('registerName').value;
  const email = document.getElementById('registerEmail').value;
  const password = document.getElementById('registerPassword').value;
  const role = document.getElementById('registerRole').value;

  try {
    const response = await fetch('/auth/register', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ name, email, password, role }),
    });

    const data = await response.json();
    if (response.ok) {
      // Save the token to localStorage
      localStorage.setItem('authToken', data.token);

      // Redirect based on role
      if (data.user.role === 'donor') {
        window.location.href = '/donor/dashboard';
      } else if (data.user.role === 'consumer') {
        window.location.href = '/consumer/dashboard';
      }
    } else {
      document.getElementById('registerError').textContent = data.error || 'Registration failed';
    }
  } catch (error) {
    document.getElementById('registerError').textContent = 'An error occurred. Please try again later.';
  }
});
document.addEventListener('DOMContentLoaded', function() {
    const token = localStorage.getItem('authToken'); 
    const role = localStorage.getItem("role")
    
    
    if (token) {
        // User is logged in
        console.log("User is logged in");
        document.getElementById("nav").innerHTML = '    <li><a href="/donor/dashboard" class="active">Dashboard<br></a></li>'+ document.getElementById("nav").innerHTML
        document.querySelector('.btn-getstarted[data-bs-target="#loginModal"]').style.display = 'none';
        document.querySelector('.btn-getstarted[data-bs-target="#registerModal"]').style.display = 'none';

          
        const logoutButton = document.createElement('a');
        logoutButton.href = '#';
        logoutButton.className = 'btn-getstarted ms-3';
        logoutButton.textContent = 'Logout';
        logoutButton.addEventListener('click', function() {
            localStorage.removeItem('authToken');
            window.location.reload(); // Reload the page to show login/register buttons again
        });
        document.querySelector('.container-fluid').appendChild(logoutButton);
    } else {
        // User is not logged in
        console.log("User is not logged in");
        document.querySelector('.btn-getstarted[data-bs-target="#loginModal"]').style.display = 'block';
        document.querySelector('.btn-getstarted[data-bs-target="#registerModal"]').style.display = 'block';
    }
});

  </script>

  <script>
    function save(event)
    {
      
  
      const city = document.getElementById('city').value;
    if (city) {
      localStorage.setItem('searchCity', city);
      localStorage.setItem('searchFlag', 'true');
      window.location.href = "/consumer/dashboard"
    } else {
      alert("Please enter a city name");
    }
    }


   
  
  </script>
</body>

</html>
